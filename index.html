<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع المحاضرات</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>موقع المحاضرات</h1>
        <nav>
            <ul>
                <li><a href="#home">الرئيسية</a></li>
                <li><a href="#upload">رفع المحاضرات</a></li>
                <li><a href="#courses">المحاضرات</a></li>
            </ul>
        </nav>
    </header>

    <section id="home">
        <h2>مرحبًا بك في موقع المحاضرات</h2>
        <p>يمكنك هنا تحميل المحاضرات وتنظيمها للوصول إليها في أي وقت.</p>
    </section>

    <!-- قسم رفع المحاضرات -->
    <section id="upload">
        <h2>رفع المحاضرات</h2>
        <!-- حقل لاختيار الملف من نوع PDF -->
        <input type="file" id="fileUpload" accept=".pdf">
        <button onclick="uploadFile()">رفع</button>
    </section>

    <!-- قسم عرض المحاضرات -->
    <section id="courses">
        <h2>قائمة المحاضرات</h2>
        <ul id="lectureList">
            <!-- سيتم عرض المحاضرات هنا -->
        </ul>
    </section>

    <!-- إضافة مكتبات Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
        // إعداد Firebase باستخدام بيانات مشروعك
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // تهيئة Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const storage = firebase.storage();
        const database = firebase.database();

        // دالة لرفع الملف إلى Firebase Storage
        function uploadFile() {
            let file = document.getElementById("fileUpload").files[0];
            
            if (!file) {
                alert("الرجاء اختيار ملف PDF لرفعه.");
                return;
            }

            if (file.type !== "application/pdf") {
                alert("الرجاء اختيار ملف PDF فقط.");
                return;
            }

            // تحميل الملف إلى Firebase Storage
            const storageRef = storage.ref().child("lectures/" + file.name);
            const uploadTask = storageRef.put(file);

            uploadTask.on("state_changed", 
                function(snapshot) {
                    // يمكنك هنا إضافة تقدم التحميل (اختياري)
                },
                function(error) {
                    alert("حدث خطأ أثناء رفع الملف.");
                },
                function() {
                    // بعد إتمام التحميل بنجاح
                    alert("تم رفع الملف بنجاح!");

                    // حفظ رابط الملف في قاعدة البيانات
                    uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
                        // تخزين الرابط في Firebase Realtime Database
                        const newLectureRef = database.ref("lectures").push();
                        newLectureRef.set({
                            name: file.name,
                            url: downloadURL
                        });
                    });
                }
            );
        }

        // دالة لعرض المحاضرات المخزنة في Firebase
        function loadLectures() {
            const lecturesRef = database.ref("lectures");
            lecturesRef.on("value", function(snapshot) {
                let lectures = snapshot.val();
                const lectureList = document.getElementById("lectureList");
                lectureList.innerHTML = "";  // مسح المحتوى القديم

                // عرض المحاضرات المخزنة
                for (let id in lectures) {
                    let li = document.createElement("li");
                    let lecture = lectures[id];
                    li.innerHTML = <a href="${lecture.url}" target="_blank">${lecture.name}</a>;
                    lectureList.appendChild(li);
                }
            });
        }

        // استدعاء الدالة عند تحميل الصفحة لعرض المحاضرات
        window.onload = function() {
            loadLectures();
        };
    </script>

</body>
</html>
